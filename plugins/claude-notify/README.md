# Claude Notify

A floating notification panel for Claude Code, built with [Hammerspoon](https://www.hammerspoon.org/).

Replaces macOS notification center stacking with a single always-on-top mini-window that accumulates notifications. Click any notification to jump directly to that terminal/tmux session.

## Features

- Floating dark-themed notification panel
- Click notification to focus the correct terminal / tmux pane
- Filter by type: All / IN (input needed) / OK (response complete)
- Read/unread status tracking (blue dot indicator)
- New notification flash animation
- Adjustable opacity (10-100% slider)
- Resizable window with standard minimize/close controls
- Hotkey toggle (default: Ctrl+Shift+N)
- Project name + tmux session tag per notification
- Works with or without tmux

## Prerequisites

- **macOS** (Hammerspoon is macOS only)
- **[Hammerspoon](https://www.hammerspoon.org/)** with CLI enabled
  - Install: `brew install --cask hammerspoon`
  - Enable CLI: Hammerspoon Preferences > Enable CLI (or run `hs.ipc.cliInstall()` in console)
- **Claude Code** with hooks support
- **tmux** (optional, for session navigation)

## Quick Start

```bash
# Clone the repo
git clone https://github.com/JeonJe/claude-plugins.git
cd claude-plugins/plugins/claude-notify

# Run interactive setup
bash setup.sh
```

The setup script will:
1. Detect Hammerspoon CLI path
2. Detect your terminal app (Ghostty, iTerm2, Terminal, WezTerm, etc.)
3. Detect tmux (optional)
4. Ask notification language (English / Korean)
5. Configure hotkey and HTTP port
6. Copy files and generate configs
7. Print the Claude Code hook settings to add to `~/.claude/settings.json`

## How It Works

```
Claude Code Hook (Notification/Stop)
  -> bash ~/.claude/hooks/notify.sh "message"
    -> captures tmux session, pane ID, project name
    -> hs -c "ClaudeNotify.push(...)"
      -> Hammerspoon webview panel updates
        -> Click notification
          -> focuses terminal + switches tmux session/pane
```

Communication between the webview and Lua uses a local HTTP server (default port 17839). No external network calls.

## Panel Controls

| Control | Description |
|---------|-------------|
| Badge | Unread notification count |
| All / IN / OK | Filter by notification type |
| Read All | Mark all notifications as read |
| Clear | Remove all notifications |
| Restart | Restart panel |
| Quit | Close panel and stop HTTP server |
| Slider | Adjust panel opacity (10-100%) |

## File Structure

After setup, files are placed in:

```
~/.hammerspoon/
  claude-notify.lua           # Main notification panel module
  claude-notify-config.lua    # Your config (generated by setup)
  init.lua                    # Add require("claude-notify") here

~/.claude/
  hooks/
    notify.sh                 # Claude Code hook script
    notify-config.sh          # Hook config (generated by setup)
  settings.json               # Add Notification/Stop hooks here
```

## Configuration

All settings are in `~/.hammerspoon/claude-notify-config.lua`:

```lua
return {
    terminal = "Ghostty",           -- Your terminal app name
    hs_path = "/opt/homebrew/bin/hs",
    tmux_path = "/opt/homebrew/bin/tmux",
    use_tmux = true,                -- Enable tmux pane navigation
    port = 17839,                   -- HTTP callback port
    hotkey_mods = { "ctrl", "shift" },
    hotkey_key = "n",
    lang = "en",                    -- "en" or "ko"
    panel = {
        width = 320,
        height = 420,
        alpha = 0.93,
        always_on_top = true,
    },
}
```

Re-run `bash setup.sh` to regenerate configs, or edit the file directly and reload Hammerspoon.

## Notification Messages

Customize the notification messages in your `~/.claude/settings.json` hooks. The panel detects notification type by emoji prefix:

| Emoji | Type | Default |
|-------|------|---------|
| Bell (U+1F514) | Input needed | Yo! |
| Check (U+2705) | Response done | Ta-da! |

You can change the message text to anything you like, as long as the emoji prefix is preserved.

## Troubleshooting

| Problem | Solution |
|---------|----------|
| `hs` command not found | Enable CLI in Hammerspoon Preferences, or run `hs.ipc.cliInstall()` in console |
| Panel doesn't appear | Check `~/.hammerspoon/init.lua` has `require("hs.ipc")` and `ClaudeNotify = require("claude-notify")` |
| Click doesn't navigate | Verify tmux is running and `use_tmux = true` in config |
| Port conflict | Change `port` in both `claude-notify-config.lua` and `notify-config.sh`, or re-run setup |
| Opacity/Clear not working | Ensure HTTP server port matches between config files |

## Note

This plugin uses Hammerspoon instead of the standard Claude Code skill pattern. It is installed via `bash setup.sh` rather than `/plugin install`.

## License

MIT
